function Offers(){function e(){Titanium.Geolocation.getCurrentPosition(function(e){if(!e.success||e.error)return void Ti.API.info("error:"+JSON.stringify(e.error));{var i=e.coords.longitude,a=e.coords.latitude,r=(e.coords.altitude,e.coords.heading,e.coords.accuracy,e.coords.speed);e.coords.timestamp,e.coords.altitudeAccuracy}Ti.API.info("speed "+r);var n="http://api.sqoot.com/v2/deals?api_key=f07pod&order=distance&per_page=50&location="+a+","+i,o=Ti.Network.createHTTPClient({onload:function(){localDeals=JSON.parse(this.responseText).deals,Ti.API.info(localDeals),t(localDeals)},onerror:function(e){Ti.API.debug(e.error),alert("error")},timeout:5e3});o.open("GET",n),o.send()})}function t(e){for(var t=2,i=e.length/2,a=[],r=0,n=0;i>n;n++){for(var s=Ti.UI.createTableViewRow({className:"grid",layout:"horizontal",height:"235dp",width:"100%"}),c=0;t>c;c++){var p=Ti.UI.createView({left:"5dp",height:"225dp",width:"150dp",backgroundColor:"#fff",borderColor:"#fcd700",borderRadius:5,borderWidth:1,url:e[r].deal.url,untracked_url:e[r].deal.untracked_url}),l=Ti.UI.createImageView({top:"0dp",image:e[r].deal.image_url,url:e[r].deal.url,untracked_url:e[r].deal.untracked_url,width:"150dp",height:"150dp"});p.add(l);var u=Ti.UI.createView({height:"25dp",width:"45dp",top:"115dp",right:"10dp",backgroundColor:"#000",borderRadius:5,borderWidth:1,borderColor:"#000",opacity:.8,url:e[r].deal.url,untracked_url:e[r].deal.untracked_url}),m=Ti.UI.createLabel({text:"$"+e[r].deal.price,font:d,color:"white",url:e[r].deal.url,untracked_url:e[r].deal.untracked_url});p.add(u),u.add(m);var f=Ti.UI.createLabel({top:"182dp",left:"2dp",text:e[r].deal.merchant.name,font:o,color:"black",url:e[r].deal.url,untracked_url:e[r].deal.untracked_url}),g=Ti.UI.createLabel({top:"150dp",text:e[r].deal.short_title,font:o,color:"#478caf",left:"2dp",right:"2dp",height:"29dp",url:e[r].deal.url,untracked_url:e[r].deal.untracked_url});p.add(g),p.add(f),s.add(p),r++}a.push(s)}T.setData(a)}function i(e,t){var i=Ti.UI.createView({height:Ti.UI.FILL,width:Ti.UI.FILL,layout:"vertical",backgroundColor:"f7b21d"}),a=Ti.UI.createView({width:"100%",height:"20dp",backgroundColor:"#000",top:"0dp",opacity:.2});i.add(a);var n=Ti.UI.createView({height:"40dp",backgroundColor:"#f7b21d"});i.add(n);var o=Ti.UI.createButton({title:"Open in Safari",right:"5dp"});n.add(o);var d=Ti.UI.createButton({title:"Close",left:"5dp"});n.add(d);var s=Ti.UI.createWebView({url:e?e:t});i.add(s),r.add(i),o.addEventListener("click",function(){Ti.Platform.openURL(e?e:t)}),d.addEventListener("click",function(){r.remove(i)})}var a="/images/offers/",r=Ti.UI.createView({height:"100%",backgroundImage:a+"background.png"}),n={fontFamily:"HelveticaNeue-Thin",fontSize:"28dp",color:"#fff"},o={fontSize:"12dp",color:"#fff"},d={fontSize:"12dp",color:"#fff",fontWeight:"bold"},s=Ti.UI.createView({width:"100%",height:"85dp",backgroundColor:"#f7b21d",top:"0dp"}),c=Ti.UI.createView({width:"100%",height:"20dp",backgroundColor:"#000",top:"0dp",opacity:.2});r.add(s);var p=Ti.UI.createImageView({image:a+"home.png",left:"12.5dp",center:{y:"52.5dp"}}),l=Ti.UI.createLabel({text:"Daily Deals",font:n,center:{y:"52.5dp"},color:"white"});r.add(l);var u=Ti.UI.createImageView({image:a+"ribbon.png",top:"0dp",right:"5dp"}),T=Ti.UI.createTableView({top:"105dp",width:"100%",separatorColor:"transparent",backgroundColor:"transparent"});return r.add(T),e(),T.addEventListener("click",function(e){(e.source.url||e.source.untracked_url)&&i(e.source.url,e.source.untracked_url)}),r.add(u),r.add(p),p.addEventListener("click",function(){r.hide()}),r.add(c),r}module.exports=Offers;